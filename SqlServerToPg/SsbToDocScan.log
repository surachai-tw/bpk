 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00000447'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00000954'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00001677'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00001876'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00001884'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00001976'  ORDER BY a.VisitDate, c.MakeDateTime
 SELECT	a.HN AS patient_id, 	convert(nvarchar(MAX), (a.VisitDate), 112) + convert(varchar(3),a.VN) + convert(varchar(2),c.PrescriptionNo) AS visit_id, 	convert(varchar(3),a.VN) AS original_vn, 	convert(varchar(3),a.VN) + '/' + convert(varchar(2),c.PrescriptionNo) AS vn, 	convert(nvarchar(MAX), (a.VisitDate), 112) AS visit_date, 	convert(nvarchar(MAX), (c.MakeDateTime), 8) AS visit_time, 	c.Doctor AS doctor_code, 	CASE WHEN e.LocalName is not null THEN 		(SELECT CASE WHEN (charindex('' , RIGHT (e.localname , len(e.localname) - 1)) > 0) THEN RIGHT (e.localname , (len(e.localname) - charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.localname , len(e.localname) - 1)) , (charindex('' , RIGHT (e.localname , len(e.localname) - 1))) - 1) ELSE RIGHT (e.localname , len(e.localname) - 1) END AS Expr1) 	ELSE  		(SELECT CASE WHEN (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1)) > 0) THEN RIGHT (e.englishname , (len(e.englishname) - charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) + ' ' + LEFT ((RIGHT (e.englishname , len(e.englishname) - 1)) , (charindex('' , RIGHT (e.englishname , len(e.englishname) - 1))) - 1) ELSE RIGHT (e.englishname , len(e.englishname) - 1) END AS Expr1) 	END AS doctor, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS original_an, 	CASE WHEN c.PrescriptionNo = 1 THEN a.AN END AS an, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 112) END AS admit_date, 	CASE WHEN c.PrescriptionNo = 1 THEN convert(nvarchar(MAX), (b.AdmDateTime), 8) END AS admit_time, 	CASE WHEN c.CloseVisitCode in ('999','006','004') THEN '0' ELSE '1' END AS active FROM	DNHOSPITAL.dbo.HNOPD_MASTER AS a left join 	DNHOSPITAL.dbo.HNIPD_MASTER AS b ON a.AN = b.AN left join 	DNHOSPITAL.dbo.HNOPD_PRESCRIP AS c ON a.VisitDate = c.VisitDate and a.VN = c.VN left join 	DNHOSPITAL.dbo.HNDOCTOR_MASTER AS e ON c.Doctor = e.Doctor WHERE	a.HN = '00002362'  ORDER BY a.VisitDate, c.MakeDateTime
